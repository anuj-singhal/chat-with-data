{
  "queries": [
    {
      "id": "q_001",
      "natural_language": "Show yearly profits for all banks in 2024",
      "variations": [
        "Display 2024 annual profits for banks",
        "Get yearly profit data for all banks in 2024",
        "What were the profits of all banks in 2024?",
        "List annual profits for each bank in 2024",
        "Show me 2024 bank profits",
        "Bank profitability for year 2024"
      ],
      "sql_query": "SELECT \n    b.BANK_NAME,\n    fp.YEAR,\n    SUM(fp.NET_PROFIT) as TOTAL_PROFIT,\n    AVG(fp.ROE) as AVG_ROE,\n    AVG(fp.ROA) as AVG_ROA\nFROM FINANCIAL_PERFORMANCE fp\nJOIN BANKS b ON fp.BANK_ID = b.BANK_ID\nWHERE fp.YEAR = 2024\nGROUP BY b.BANK_NAME, fp.YEAR\nORDER BY TOTAL_PROFIT DESC",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 100
      },
      "overall_confidence": 100,
      "last_used": "2025-01-20T09:15:00.000000"
    },
    {
      "id": "q_002",
      "natural_language": "Compare NIM trends across banks for 2023-2024",
      "variations": [
        "Show NIM comparison between banks for 2023 and 2024",
        "Net Interest Margin trends for all banks 2023-2024",
        "NIM trend analysis across banks for 2023-2024 period"
      ],
      "sql_query": "WITH nim_data AS (\n    SELECT \n        b.BANK_NAME,\n        fp.YEAR,\n        fp.QUARTER,\n        fp.NIM,\n        AVG(fp.NIM) OVER (PARTITION BY b.BANK_NAME, fp.YEAR) as YEARLY_AVG_NIM\n    FROM FINANCIAL_PERFORMANCE fp\n    JOIN BANKS b ON fp.BANK_ID = b.BANK_ID\n    WHERE fp.YEAR IN (2023, 2024)\n),\nyearly_comparison AS (\n    SELECT \n        BANK_NAME,\n        MAX(CASE WHEN YEAR = 2023 THEN YEARLY_AVG_NIM END) as NIM_2023,\n        MAX(CASE WHEN YEAR = 2024 THEN YEARLY_AVG_NIM END) as NIM_2024,\n        (MAX(CASE WHEN YEAR = 2024 THEN YEARLY_AVG_NIM END) - \n         MAX(CASE WHEN YEAR = 2023 THEN YEARLY_AVG_NIM END)) as NIM_CHANGE\n    FROM nim_data\n    GROUP BY BANK_NAME\n)\nSELECT \n    BANK_NAME,\n    ROUND(NIM_2023, 2) as NIM_2023,\n    ROUND(NIM_2024, 2) as NIM_2024,\n    ROUND(NIM_CHANGE, 2) as CHANGE,\n    ROUND((NIM_CHANGE / NIM_2023) * 100, 2) as CHANGE_PCT\nFROM yearly_comparison\nORDER BY NIM_CHANGE DESC",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 95,
        "completeness": 100
      },
      "overall_confidence": 98,
      "last_used": "2025-01-19T14:30:00.000000"
    },
    {
      "id": "q_003",
      "natural_language": "Compare deposit growth between Mashreq and ADCB for 2023",
      "variations": [
        "Show deposit changes for Mashreq vs ADCB in 2023",
        "How did Mashreq and ADCB deposits grow in 2023?",
        "Analyze deposit trends for Mashreq compared to ADCB for 2023",
        "Compare deposits for Mashreq and ADCB in 2023",
        "Mashreq vs ADCB deposit growth analysis 2023",
        "Get 2023 deposit comparison between Mashreq and ADCB"
      ],
      "sql_query": "WITH deposit_data AS (\n  SELECT \n    b.BANK_NAME,\n    fp.QUARTER,\n    fp.YEAR,\n    fp.TOTAL_DEPOSITS,\n    LAG(fp.TOTAL_DEPOSITS) OVER (PARTITION BY b.BANK_NAME ORDER BY fp.YEAR, fp.QUARTER) as prev_deposits\n  FROM FINANCIAL_PERFORMANCE fp\n  JOIN BANKS b ON fp.BANK_ID = b.BANK_ID\n  WHERE b.BANK_NAME IN ('Mashreq', 'ADCB') AND fp.YEAR = 2023\n)\nSELECT \n  BANK_NAME,\n  QUARTER,\n  TOTAL_DEPOSITS,\n  ROUND((TOTAL_DEPOSITS - prev_deposits) / prev_deposits * 100, 2) as growth_pct\nFROM deposit_data\nORDER BY BANK_NAME, QUARTER",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 95,
        "completeness": 100
      },
      "overall_confidence": 98,
      "last_used": "2025-01-18T11:22:10.123456"
    },
    {
      "id": "q_004",
      "natural_language": "Show top 5 banks by market capitalization",
      "variations": [
        "List top 5 banks by market cap",
        "Which are the 5 largest banks by market value?",
        "Get top 5 banks ranked by market capitalization",
        "Display 5 biggest banks by market cap",
        "Show me the top 5 banks by market value",
        "5 largest banks by market capitalization"
      ],
      "sql_query": "SELECT \n    b.BANK_NAME,\n    md.MARKET_CAP,\n    md.SHARE_PRICE,\n    md.PE_RATIO,\n    md.PRICE_TO_BOOK\nFROM MARKET_DATA md\nJOIN BANKS b ON md.BANK_ID = b.BANK_ID\nWHERE md.DATE = (SELECT MAX(DATE) FROM MARKET_DATA)\nORDER BY md.MARKET_CAP DESC\nLIMIT 5",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 100
      },
      "overall_confidence": 100,
      "last_used": "2025-01-17T16:45:00.000000"
    },
    {
      "id": "q_005",
      "natural_language": "Calculate average CASA ratio for Q4 2023",
      "variations": [
        "What was the average CASA ratio in Q4 2023?",
        "Get mean CASA ratio for fourth quarter 2023",
        "Average CASA for all banks Q4 2023",
        "Show average CASA ratio in Q4 of 2023",
        "Calculate mean CASA ratio for Q4 2023"
      ],
      "sql_query": "SELECT \n    ROUND(AVG(fp.CASA_RATIO), 2) as AVG_CASA_RATIO,\n    COUNT(DISTINCT b.BANK_ID) as NUM_BANKS,\n    MIN(fp.CASA_RATIO) as MIN_CASA,\n    MAX(fp.CASA_RATIO) as MAX_CASA\nFROM FINANCIAL_PERFORMANCE fp\nJOIN BANKS b ON fp.BANK_ID = b.BANK_ID\nWHERE fp.YEAR = 2023 AND fp.QUARTER = 4",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 95
      },
      "overall_confidence": 98,
      "last_used": "2025-01-16T10:30:00.000000"
    },
    {
      "id": "q_006",
      "natural_language": "Show quarterly revenue trend for FAB in 2023",
      "variations": [
        "FAB quarterly revenue for 2023",
        "Display FAB revenue by quarter in 2023",
        "Get quarterly revenue trends for FAB in 2023",
        "Show FAB's revenue each quarter of 2023",
        "FAB 2023 quarterly revenue progression"
      ],
      "sql_query": "SELECT \n    b.BANK_NAME,\n    fp.QUARTER,\n    fp.YEAR,\n    fp.TOTAL_REVENUE,\n    fp.NET_INTEREST_INCOME,\n    fp.NON_INTEREST_INCOME,\n    ROUND(((fp.TOTAL_REVENUE - LAG(fp.TOTAL_REVENUE) OVER (ORDER BY fp.QUARTER)) / \n           LAG(fp.TOTAL_REVENUE) OVER (ORDER BY fp.QUARTER)) * 100, 2) as QOQ_GROWTH\nFROM FINANCIAL_PERFORMANCE fp\nJOIN BANKS b ON fp.BANK_ID = b.BANK_ID\nWHERE b.BANK_NAME = 'FAB' AND fp.YEAR = 2023\nORDER BY fp.QUARTER",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 100
      },
      "overall_confidence": 100,
      "last_used": "2025-01-15T15:20:00.000000"
    },
    {
      "id": "q_007",
      "natural_language": "Compare ROE and ROA for all banks in latest quarter",
      "variations": [
        "Show ROE vs ROA for banks in most recent quarter",
        "Compare return on equity and assets for all banks latest quarter",
        "Get ROE and ROA comparison for banks in latest quarter",
        "Display ROE and ROA metrics for all banks recent quarter",
        "Latest quarter ROE ROA comparison across banks"
      ],
      "sql_query": "WITH latest_quarter AS (\n    SELECT MAX(YEAR) as max_year, MAX(QUARTER) as max_quarter\n    FROM FINANCIAL_PERFORMANCE\n    WHERE YEAR = (SELECT MAX(YEAR) FROM FINANCIAL_PERFORMANCE)\n)\nSELECT \n    b.BANK_NAME,\n    fp.ROE,\n    fp.ROA,\n    ROUND(fp.ROE / fp.ROA, 2) as LEVERAGE_RATIO,\n    fp.QUARTER,\n    fp.YEAR\nFROM FINANCIAL_PERFORMANCE fp\nJOIN BANKS b ON fp.BANK_ID = b.BANK_ID\nJOIN latest_quarter lq ON fp.YEAR = lq.max_year AND fp.QUARTER = lq.max_quarter\nORDER BY fp.ROE DESC",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 95,
        "completeness": 100
      },
      "overall_confidence": 98,
      "last_used": "2025-01-14T09:00:00.000000"
    },
    {
      "id": "q_008",
      "natural_language": "Find banks with CET1 ratio below 12%",
      "variations": [
        "Which banks have CET1 less than 12%?",
        "Show banks where CET1 ratio is under 12",
        "List banks with capital ratio below 12%",
        "Get banks with CET1 lower than 12 percent",
        "Banks with Common Equity Tier 1 below 12%"
      ],
      "sql_query": "SELECT DISTINCT\n    b.BANK_NAME,\n    fp.CET1,\n    fp.QUARTER,\n    fp.YEAR,\n    CASE \n        WHEN fp.CET1 < 10 THEN 'Critical'\n        WHEN fp.CET1 < 11 THEN 'Low'\n        ELSE 'Below Target'\n    END as RISK_LEVEL\nFROM FINANCIAL_PERFORMANCE fp\nJOIN BANKS b ON fp.BANK_ID = b.BANK_ID\nWHERE fp.CET1 < 12\n    AND fp.YEAR = (SELECT MAX(YEAR) FROM FINANCIAL_PERFORMANCE)\n    AND fp.QUARTER = (SELECT MAX(QUARTER) FROM FINANCIAL_PERFORMANCE WHERE YEAR = (SELECT MAX(YEAR) FROM FINANCIAL_PERFORMANCE))\nORDER BY fp.CET1 ASC",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 100
      },
      "overall_confidence": 100,
      "last_used": "2025-01-13T14:15:00.000000"
    },
    {
      "id": "q_010",
      "natural_language": "Show net profit for all banks in 2024",
      "variations": [],
      "sql_query": "SELECT \n    b.BANK_ID,\n    b.BANK_NAME,\n    COALESCE(SUM(fp.YTD_INCOME), 0) AS NET_PROFIT\nFROM \n    BANKS b\nLEFT JOIN \n    FINANCIAL_PERFORMANCE fp ON b.BANK_ID = fp.BANK_ID AND fp.YEAR = 2024\nGROUP BY \n    b.BANK_ID, b.BANK_NAME\nORDER BY \n    b.BANK_NAME;\n",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 100
      },
      "overall_confidence": 100,
      "last_used": "2025-10-26T15:47:08.542191"
    },
    {
      "id": "q_011",
      "natural_language": "Market capitalization comparison for Q4 2024",
      "variations": [],
      "sql_query": "WITH CET1_data AS (\n    SELECT \n        BANK_ID,\n        SUM(CASE WHEN YEAR = 2024 AND QUARTER = 4 THEN CET1 ELSE 0 END) AS total_CET1_Q4_2024,\n        SUM(CASE WHEN YEAR = 2023 AND QUARTER = 4 THEN CET1 ELSE 0 END) AS total_CET1_Q4_2023\n    FROM \n        MARKET_DATA\n    WHERE \n        (YEAR = 2024 AND QUARTER = 4) OR (YEAR = 2023 AND QUARTER = 4)\n    GROUP BY \n        BANK_ID\n)\nSELECT \n    B.BANK_NAME,\n    COALESCE(CD.total_CET1_Q4_2024, 0) AS total_CET1_Q4_2024,\n    COALESCE(CD.total_CET1_Q4_2023, 0) AS total_CET1_Q4_2023\nFROM \n    BANKS B\nLEFT JOIN \n    CET1_data CD ON B.BANK_ID = CD.BANK_ID\nORDER BY \n    total_CET1_Q4_2024 DESC;\n",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 100
      },
      "overall_confidence": 100,
      "last_used": "2025-10-26T17:40:23.384806"
    },
    {
      "id": "q_012",
      "natural_language": "Growth analysis - YoY profit growth for 2024 vs 2023",
      "variations": [],
      "sql_query": "SELECT \n    (SUM(CASE WHEN YEAR = 2024 THEN YTD_INCOME END) - \n     SUM(CASE WHEN YEAR = 2023 THEN YTD_INCOME END)) / \n     NULLIF(SUM(CASE WHEN YEAR = 2023 THEN YTD_INCOME END), 0) AS YoY_Profit_Growth\nFROM \n    FINANCIAL_PERFORMANCE\nWHERE \n    YEAR IN (2023, 2024);\n",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 100
      },
      "overall_confidence": 100,
      "last_used": "2025-10-26T17:43:03.285564"
    },
    {
      "id": "q_013",
      "natural_language": "Quarterly trend analysis for ENBD",
      "variations": [],
      "sql_query": "SELECT \n    fp.YEAR,\n    fp.QUARTER,\n    SUM(fp.YTD_INCOME) AS TOTAL_YTD_INCOME,\n    LAG(SUM(fp.YTD_INCOME)) OVER (PARTITION BY fp.BANK_ID ORDER BY fp.YEAR, fp.QUARTER) AS PREVIOUS_QUARTER_INCOME,\n    SUM(fp.YTD_INCOME) - LAG(SUM(fp.YTD_INCOME)) OVER (PARTITION BY fp.BANK_ID ORDER BY fp.YEAR, fp.QUARTER) AS QUARTER_OVER_QUARTER_CHANGE\nFROM \n    FINANCIAL_PERFORMANCE fp\nJOIN \n    BANKS b ON fp.BANK_ID = b.BANK_ID\nWHERE \n    (b.BANK_NAME = 'ENBD' OR b.BANK_CODE = 'ENBD')\n    AND b.BANK_NAME IS NOT NULL\n    AND b.BANK_CODE IS NOT NULL\nGROUP BY \n    fp.YEAR, fp.QUARTER, fp.BANK_ID\nORDER BY \n    fp.YEAR, fp.QUARTER;\n",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 90,
        "completeness": 90
      },
      "overall_confidence": 95,
      "last_used": "2025-10-26T18:12:21.789843"
    },
    {
      "id": "q_014",
      "natural_language": "Market capitalization comparison for Q4 2024 for all banks",
      "variations": [],
      "sql_query": "SELECT \n    b.BANK_ID,\n    b.BANK_NAME,\n    md.CET1,\n    RANK() OVER (ORDER BY md.CET1 DESC) AS CET1_RANK\nFROM \n    MARKET_DATA md\nJOIN \n    BANKS b ON md.BANK_ID = b.BANK_ID\nWHERE \n    md.YEAR = 2024 \n    AND md.QUARTER = 4\nORDER BY \n    md.CET1 DESC;\n",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 100
      },
      "overall_confidence": 100,
      "last_used": "2025-10-26T18:17:46.951470"
    },
    {
      "id": "q_015",
      "natural_language": "ompare NIM trends across banks for 2023-2024",
      "variations": [],
      "sql_query": "WITH FilteredPerformance AS (\n    SELECT BANK_ID, YEAR, QUARTER, YTD_INCOME \n    FROM FINANCIAL_PERFORMANCE \n    WHERE YEAR IN (2023, 2024)\n),\nFilteredMarketData AS (\n    SELECT BANK_ID, YEAR, QUARTER, CET1 \n    FROM MARKET_DATA \n    WHERE YEAR IN (2023, 2024)\n),\nJoinedData AS (\n    SELECT FP.BANK_ID, B.BANK_NAME, FP.YEAR, FP.QUARTER, FP.YTD_INCOME, MD.CET1 \n    FROM FilteredPerformance FP \n    JOIN BANKS B ON FP.BANK_ID = B.BANK_ID\n    JOIN FilteredMarketData MD ON FP.BANK_ID = MD.BANK_ID AND FP.YEAR = MD.YEAR AND FP.QUARTER = MD.QUARTER\n)\nSELECT BANK_ID, BANK_NAME, YEAR, QUARTER, \n       (YTD_INCOME / CET1) AS NIM \nFROM JoinedData \nORDER BY BANK_ID, YEAR, QUARTER;\n",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 90,
        "completeness": 90
      },
      "overall_confidence": 95,
      "last_used": "2025-10-26T18:23:04.363101"
    },
    {
      "id": "q_016",
      "natural_language": "Annual earnings for all banks in 2024",
      "variations": [],
      "sql_query": "SELECT B.BANK_NAME, SUM(FP.YTD_INCOME) AS ANNUAL_EARNINGS \nFROM BANKS B \nJOIN FINANCIAL_PERFORMANCE FP ON B.BANK_ID = FP.BANK_ID \nWHERE FP.YEAR = 2024 \nGROUP BY B.BANK_NAME;\n",
      "validation_result": {
        "schema": 100,
        "syntax": 100,
        "semantic": 100,
        "completeness": 100
      },
      "overall_confidence": 100,
      "last_used": "2025-10-26T18:23:34.119140"
    }
  ]
}